# Application configuration file

# Model: TRANSPORT
TRANSP_USE_IBP="YES"
TRANSP_USE_GFEM_AT_BOUNDARY="YES"

# Model: HYDRO
HYDRO_USE_IBP="YES"
HYDRO_USE_ENTROPYFIX="HARTEN_ENTROPYFIX"
HYDRO_HARTEN_ENTROPYFIX="0.5"
HYDRO_USE_GFEM_AT_BOUNDARY="YES"
HYDRO_GAMMA="1.4"

# Model: MHD
MHD_USE_IBP="YES"
MHD_USE_GFEM_AT_BOUNDARY="YES"
MHD_USE_ENTROPYFIX="NO"
MHD_HARTEN_ENTROPYFIX="0.0"
MHD_GAMMA="1.4"
MHD_VACUUM_PERM="1.0"
MHD_XMAGFIELD_CONST="0.75"

# Kernel
MEMORY_LAYOUT="COLUMN_MAJOR_ORDER"

# Optimised configuration flags for large problems
LINALG_NMIN_OMP="32*120"
LSYSSC_NEQMIN_OMP="32*100"
AFCSTAB_NEDGEMIN_OMP="32*100"
AFCSC_NEQMIN_OMP="32*150"
AFCSC_NEDGEMIN_OMP="32*120"
AFCSC_NAMIN_OMP="32*150"
AFCSYS_NEQMIN_OMP="32*150"
AFCSYS_NEDGEMIN_OMP="32*120"
AFCSYS_NAMIN_OMP="32*150"
GFSC_NEQMIN_OMP="32*150"
GFSC_NEDGEMIN_OMP="32*120"
GFSC_NAMIN_OMP="32*150"
GFSYS_NEQMIN_OMP="32*150"
GFSYS_NEDGEMIN_OMP="32*120"
GFSYS_NAMIN_OMP="32*150"
BILF_NELEMSIM="32*160"
LINF_NELEMSIM="32*1"
GFSC_NEQSIM="32"
GFSC_NEDGESIM="32"
GFSC_NASIM="32"
GFSYS_NEQSIM="32*50"
GFSYS_NEDGESIM="32*25"
GFSYS_NASIM="32*50"
AFCSC_NEQSIM="32*50"
AFCSC_NEDGESIM="32*25"
AFCSC_NASIM="32*50"
AFCSYS_NEQSIM="32*50"
AFCSYS_NEDGESIM="32*25"
AFCSYS_NASIM="32*50"
FPAR_NITEMSIM="32*130"

#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#
#-#-#-#-#                 DO NOT EDIT THE LINES BELOW                 #-#-#-#-#
#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#

# Start with non-optional apponly flags
APPONLYFLAGS="-DUSE_PREPROC_F90CPP"
MESSAGE=""

#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#
#-#-#-#-#               Add flags for transport model                 #-#-#-#-#
#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#

# Apply integration by parts to the divergence term
if [ -n "$TRANSP_USE_IBP" -a "$TRANSP_USE_IBP" = "YES" ]
then
  APPONLYFLAGS="$APPONLYFLAGS,-DTRANSP_USE_IBP"
  MESSAGE="\nTRANSP_USE_IBP = YES"
else
  MESSAGE="\nTRANSP_USE_IBP = NO"
fi

# Apply group finite element formulation also at the boundary
if [ -n "$TRANSP_USE_GFEM_AT_BOUNDARY" -a "$TRANSP_USE_GFEM_AT_BOUNDARY" = "YES" ]
then
  APPONLYFLAGS="$APPONLYFLAGS,-DTRANSP_USE_GFEM_AT_BOUNDARY"
  MESSAGE="$MESSAGE\nTRANSP_USE_GFEM_AT_BOUNDARY = YES"
else
  MESSAGE="$MESSAGE\nTRANSP_USE_GFEM_AT_BOUNDARY = NO"
fi

#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#
#-#-#-#-#               Add flags for hydrodynamic model              #-#-#-#-#
#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#

# Apply integration by parts to the divergence term
if [ -n "$HYDRO_USE_IBP" -a "$HYDRO_USE_IBP" = "YES" ]
then
  APPONLYFLAGS="$APPONLYFLAGS,-DHYDRO_USE_IBP"
  MESSAGE="$MESSAGE\nHYDRO_USE_IBP = YES"
else
  MESSAGE="$MESSAGE\nHYDRO_USE_IBP = NO"
fi

# Apply group finite element formulation also at the boundary
if [ -n "$HYDRO_USE_GFEM_AT_BOUNDARY" -a "$HYDRO_USE_GFEM_AT_BOUNDARY" = "YES" ]
then
  APPONLYFLAGS="$APPONLYFLAGS,-DHYDRO_USE_GFEM_AT_BOUNDARY"
  MESSAGE="$MESSAGE\nHYDRO_USE_GFEM_AT_BOUNDARY = YES"
else
  MESSAGE="$MESSAGE\nHYDRO_USE_GFEM_AT_BOUNDARY = NO"
fi

# Apply entropy fix for inviscid fluxes
if [ -n "$HYDRO_USE_ENTROPYFIX" -a "$HYDRO_USE_ENTROPYFIX" != "NO" ]
then
  APPONLYFLAGS="$APPONLYFLAGS,-DHYDRO_USE_ENTROPYFIX=${HYDRO_USE_ENTROPYFIX}"
  MESSAGE="$MESSAGE\nHYDRO_USE_ENTROPYFIX = ${HYDRO_USE_ENTROPYFIX}"
else
  MESSAGE="$MESSAGE\nHYDRO_USE_ENTROPYFIX = NO"
fi

# Define constant for Harten's entropy fix
if [ -n "$HYDRO_HARTEN_ENTROPYFIX" -a "$HYDRO_HARTEN_ENTROPYFIX" != "0" -a "$HYDRO_HARTEN_ENTROPYFIX" != "0.0" ]
then
  APPONLYFLAGS="$APPONLYFLAGS,-DHYDRO_HARTEN_ENTROPYFIX=${HYDRO_HARTEN_ENTROPYFIX}"
  MESSAGE="$MESSAGE\nHYDRO_HARTEN_ENTROPYFIX = ${HYDRO_HARTEN_ENTROPYFIX}"
fi

# Define the ratio of specific heats
if [ -n "$HYDRO_GAMMA" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DHYDRO_GAMMA=${HYDRO_GAMMA}"
    MESSAGE="$MESSAGE\nHYDRO_GAMMA = ${HYDRO_GAMMA}"
fi

#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#
#-#-#-#-#          Add flags for magnetochydrodynamic model           #-#-#-#-#
#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#

# Apply integration by parts to the divergence term
if [ -n "$MHD_USE_IBP" -a "$MHD_USE_IBP" = "YES" ]
then
  APPONLYFLAGS="$APPONLYFLAGS,-DMHD_USE_IBP"
  MESSAGE="$MESSAGE\nMHD_USE_IBP = YES"
else
  MESSAGE="$MESSAGE\nMHD_USE_IBP = NO"
fi

# Apply group finite element formulation also at the boundary
if [ -n "$MHD_USE_GFEM_AT_BOUNDARY" -a "$MHD_USE_GFEM_AT_BOUNDARY" = "YES" ]
then
  APPONLYFLAGS="$APPONLYFLAGS,-DMHD_USE_GFEM_AT_BOUNDARY"
  MESSAGE="$MESSAGE\nMHD_USE_GFEM_AT_BOUNDARY = YES"
else
  MESSAGE="$MESSAGE\nMHD_USE_GFEM_AT_BOUNDARY = NO"
fi

# Apply entropy fix for inviscid fluxes
if [ -n "$MHD_USE_ENTROPYFIX" -a "$MHD_USE_ENTROPYFIX" != "NO" ]
then
  APPONLYFLAGS="$APPONLYFLAGS,-DMHD_USE_ENTROPYFIX=${MHD_USE_ENTROPYFIX}"
  MESSAGE="$MESSAGE\nMHD_USE_ENTROPYFIX = ${MHD_USE_ENTROPYFIX}"
else
  MESSAGE="$MESSAGE\nMHD_USE_ENTROPYFIX = NO"
fi

# Define constant for Harten's entropy fix
if [ -n "$MHD_HARTEN_ENTROPYFIX" -a "$MHD_HARTEN_ENTROPYFIX" != "0" -a "$MHD_HARTEN_ENTROPYFIX" != "0.0" ]
then
  APPONLYFLAGS="$APPONLYFLAGS,-DMHD_HARTEN_ENTROPYFIX=${MHD_HARTEN_ENTROPYFIX}"
  MESSAGE="$MESSAGE\nMHD_HARTEN_ENTROPYFIX = ${MHD_HARTEN_ENTROPYFIX}"
fi

# Define the ratio of specific heats
if [ -n "$MHD_GAMMA" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DMHD_GAMMA=${MHD_GAMMA}"
    MESSAGE="$MESSAGE\nMHD_GAMMA = ${MHD_GAMMA}"
fi

# Define the vacuum permeability coefficient
if [ -n "$MHD_VACUUM_PERM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DMHD_VACUUM_PERM=${MHD_VACUUM_PERM}"
    MESSAGE="$MESSAGE\nMHD_VACUUM_PERM = ${MHD_VACUUM_PERM}"
fi

# Define the constant value of the x-component of the magnetic field in 1D
if [ -n "$MHD_XMAGFIELD_CONST" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DMHD_XMAGFIELD_CONST=${MHD_XMAGFIELD_CONST}"
    MESSAGE="$MESSAGE\nMHD_XMAGFIELD_CONST = ${MHD_XMAGFIELD_CONST}"
fi

#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#
#-#-#-#-#               Add flags for kernel routines                 #-#-#-#-#
#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#

if [ -n "$MEMORY_LAYOUT" ]
then 
     APPONLYFLAGS="$APPONLYFLAGS,-DMEMORY_LAYOUT=${MEMORY_LAYOUT}"
     MESSAGE="$MESSAGE\nMEMORY_LAYOUT = ${MEMORY_LAYOUT}"
fi

#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#
#-#-#-#-#     Add flags for blocking and OpenMP parallelisation       #-#-#-#-#
#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#

if [ -n "LINALG_NMIN_OMP" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DLINALG_NMIN_OMP=${LINALG_NMIN_OMP}"
    MESSAGE="$MESSAGE\nLINALG_NMIN_OMP = ${LINALG_NMIN_OMP}"
fi

if [ -n "LSYSSC_NEQMIN_OMP" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DLSYSSC_NEQMIN_OMP=${LSYSSC_NEQMIN_OMP}"
    MESSAGE="$MESSAGE\nLSYSSC_NEQMIN_OMP = ${LSYSSC_NEQMIN_OMP}"
fi

if [ -n "AFCSTAB_NEDGEMIN_OMP" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DAFCSTAB_NEDGEMIN_OMP=${AFCSTAB_NEDGEMIN_OMP}"
    MESSAGE="$MESSAGE\nAFCSTAB_NEDGEMIN_OMP = ${AFCSTAB_NEDGEMIN_OMP}"
fi

if [ -n "AFCSC_NEQMIN_OMP" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DAFCSC_NEQMIN_OMP=${AFCSC_NEQMIN_OMP}"
    MESSAGE="$MESSAGE\nAFCSC_NEQMIN_OMP = ${AFCSC_NEQMIN_OMP}"
fi

if [ -n "AFCSC_NEDGEMIN_OMP" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DAFCSC_NEDGEMIN_OMP=${AFCSC_NEDGEMIN_OMP}"
    MESSAGE="$MESSAGE\nAFCSC_NEDGEMIN_OMP = ${AFCSC_NEDGEMIN_OMP}"
fi

if [ -n "AFCSC_NAMIN_OMP" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DAFCSC_NAMIN_OMP=${AFCSC_NAMIN_OMP}"
    MESSAGE="$MESSAGE\nAFCSC_NAMIN_OMP = ${AFCSC_NAMIN_OMP}"
fi

if [ -n "AFCSYS_NEQMIN_OMP" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DAFCSYS_NEQMIN_OMP=${AFCSYS_NEQMIN_OMP}"
    MESSAGE="$MESSAGE\nAFCSYS_NEQMIN_OMP = ${AFCSYS_NEQMIN_OMP}"
fi

if [ -n "AFCSYS_NEDGEMIN_OMP" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DAFCSYS_NEDGEMIN_OMP=${AFCSYS_NEDGEMIN_OMP}"
    MESSAGE="$MESSAGE\nAFCSYS_NEDGEMIN_OMP = ${AFCSYS_NEDGEMIN_OMP}"
fi

if [ -n "AFCSYS_NAMIN_OMP" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DAFCSYS_NAMIN_OMP=${AFCSYS_NAMIN_OMP}"
    MESSAGE="$MESSAGE\nAFCSYS_NAMIN_OMP = ${AFCSYS_NAMIN_OMP}"
fi


if [ -n "GFSC_NEQMIN_OMP" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DGFSC_NEQMIN_OMP=${GFSC_NEQMIN_OMP}"
    MESSAGE="$MESSAGE\nGFSC_NEQMIN_OMP = ${GFSC_NEQMIN_OMP}"
fi

if [ -n "GFSC_NEDGEMIN_OMP" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DGFSC_NEDGEMIN_OMP=${GFSC_NEDGEMIN_OMP}"
    MESSAGE="$MESSAGE\nGFSC_NEDGEMIN_OMP = ${GFSC_NEDGEMIN_OMP}"
fi

if [ -n "GFSC_NAMIN_OMP" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DGFSC_NAMIN_OMP=${GFSC_NAMIN_OMP}"
    MESSAGE="$MESSAGE\nGFSC_NAMIN_OMP = ${GFSC_NAMIN_OMP}"
fi

if [ -n "GFSYS_NEQMIN_OMP" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DGFSYS_NEQMIN_OMP=${GFSYS_NEQMIN_OMP}"
    MESSAGE="$MESSAGE\nGFSYS_NEQMIN_OMP = ${GFSYS_NEQMIN_OMP}"
fi

if [ -n "GFSYS_NEDGEMIN_OMP" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DGFSYS_NEDGEMIN_OMP=${GFSYS_NEDGEMIN_OMP}"
    MESSAGE="$MESSAGE\nGFSYS_NEDGEMIN_OMP = ${GFSYS_NEDGEMIN_OMP}"
fi

if [ -n "GFSYS_NAMIN_OMP" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DGFSYS_NAMIN_OMP=${GFSYS_NAMIN_OMP}"
    MESSAGE="$MESSAGE\nGFSYS_NAMIN_OMP = ${GFSYS_NAMIN_OMP}"
fi

if [ -n "BILF_NELEMSIM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DBILF_NELEMSIM=${BILF_NELEMSIM}"
    MESSAGE="$MESSAGE\nBILF_NELEMSIM = ${BILF_NELEMSIM}"
fi

if [ -n "LINF_NELEMSIM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DLINF_NELEMSIM=${LINF_NELEMSIM}"
    MESSAGE="$MESSAGE\nLINF_NELEMSIM = ${LINF_NELEMSIM}"
fi

if [ -n "AFCSC_NEQSIM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DAFCSC_NEQSIM=${AFCSC_NEQSIM}"
    MESSAGE="$MESSAGE\nAFCSC_NEQSIM = ${AFCSC_NEQSIM}"
fi

if [ -n "AFCSC_NEDGESIM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DAFCSC_NEDGESIM=${AFCSC_NEDGESIM}"
    MESSAGE="$MESSAGE\nAFCSC_NEDGESIM = ${AFCSC_NEDGESIM}"
fi

if [ -n "AFCSC_NASIM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DAFCSC_NASIM=${AFCSC_NASIM}"
    MESSAGE="$MESSAGE\nAFCSC_NASIM = ${AFCSC_NASIM}"
fi

if [ -n "AFCSYS_NEQSIM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DAFCSYS_NEQSIM=${AFCSYS_NEQSIM}"
    MESSAGE="$MESSAGE\nAFCSYS_NEQSIM = ${AFCSYS_NEQSIM}"
fi

if [ -n "AFCSYS_NEDGESIM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DAFCSYS_NEDGESIM=${AFCSYS_NEDGESIM}"
    MESSAGE="$MESSAGE\nAFCSYS_NEDGESIM = ${AFCSYS_NEDGESIM}"
fi

if [ -n "AFCSYS_NASIM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DAFCSYS_NASIM=${AFCSYS_NASIM}"
    MESSAGE="$MESSAGE\nAFCSYS_NASIM = ${AFCSYS_NASIM}"
fi

if [ -n "GFSC_NEQSIM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DGFSC_NEQSIM=${GFSC_NEQSIM}"
    MESSAGE="$MESSAGE\nGFSC_NEQSIM = ${GFSC_NEQSIM}"
fi

if [ -n "GFSC_NEDGESIM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DGFSC_NEDGESIM=${GFSC_NEDGESIM}"
    MESSAGE="$MESSAGE\nGFSC_NEDGESIM = ${GFSC_NEDGESIM}"
fi

if [ -n "GFSC_NASIM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DGFSC_NASIM=${GFSC_NASIM}"
    MESSAGE="$MESSAGE\nGFSC_NASIM = ${GFSC_NASIM}"
fi

if [ -n "GFSYS_NEQSIM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DGFSYS_NEQSIM=${GFSYS_NEQSIM}"
    MESSAGE="$MESSAGE\nGFSYS_NEQSIM = ${GFSYS_NEQSIM}"
fi

if [ -n "GFSYS_NEDGESIM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DGFSYS_NEDGESIM=${GFSYS_NEDGESIM}"
    MESSAGE="$MESSAGE\nGFSYS_NEDGESIM = ${GFSYS_NEDGESIM}"
fi

if [ -n "GFSYS_NASIM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DGFSYS_NASIM=${GFSYS_NASIM}"
    MESSAGE="$MESSAGE\nGFSYS_NASIM = ${GFSYS_NASIM}"
fi

if [ -n "FPAR_NITEMSIM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DFPAR_NITEMSIM=${FPAR_NITEMSIM}"
    MESSAGE="$MESSAGE\nFPAR_NITEMSIM = ${FPAR_NITEMSIM}"
fi
