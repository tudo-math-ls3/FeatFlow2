# Application configuration file

# Model: TRANSPORT
TRANSP_USE_IBP="YES"
TRANSP_USE_GFEM_AT_BOUNDARY="YES"

# Model: HYDRO
HYDRO_USE_IBP="YES"
HYDRO_USE_ENTROPYFIX="YES"
HYDRO_USE_GFEM_AT_BOUNDARY="YES"
HYDRO_GAMMA="1.4"

# Model: MHD
MHD_USE_IBP="YES"
MHD_USE_GFEM_AT_BOUNDARY="YES"
MHD_USE_ENTROPYFIX="YES"
MHD_GAMMA="1.4_DP"
MHD_VACUUM_PERM="1.0_DP"
MHD_X_MAGNETICFIELD_CONSTANT_1D="0.75_DP"

# Kernel
MEMORY_LAYOUT="COLUMN_MAJOR_ORDER"
GFSYS_USE_SAFE_FPA="YES"
GFSC_USE_SAFE_FPA="YES"

# Optimised configuration flags for large problems
LINALG_NMIN_OMP="32*120"
LSYSSC_NEQMIN_OMP="32*100"
AFCSTAB_NEDGEMIN_OMP="32*100"
GFSC_NEQMIN_OMP="32*150"
GFSC_NEDGEMIN_OMP="32*120"
GFSYS_NEQMIN_OMP="32*150"
GFSYS_NEDGEMIN_OMP="32*120"
BILF_NELEMSIM="32*160"
LINF_NELEMSIM="32*1"
GFSC_NEQSIM="32*50"
GFSC_NEDGESIM="32*25"
GFSYS_NEQSIM="32*50"
GFSYS_NEDGESIM="32*25"
FPAR_NITEMSIM="32*130"

#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#
#-#-#-#-#                 DO NOT EDIT THE LINES BELOW                 #-#-#-#-#
#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#

# Start with non-optional apponly flags
APPONLYFLAGS="-DUSE_PREPROC_F90CPP"
MESSAGE=""

#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#
#-#-#-#-#               Add flags for transport model                 #-#-#-#-#
#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#

# Apply integration by parts to the divergence term
if [ -n "$TRANSP_USE_IBP" -a "$TRANSP_USE_IBP" = "YES" ]
then
  APPONLYFLAGS="$APPONLYFLAGS,-DTRANSP_USE_IBP"
  MESSAGE="\nTRANSP_USE_IBP = YES"
else
  MESSAGE="\nTRANSP_USE_IBP = NO"
fi

# Apply group finite element formulation also at the boundary
if [ -n "$TRANSP_USE_GFEM_AT_BOUNDARY" -a "$TRANSP_USE_GFEM_AT_BOUNDARY" = "YES" ]
then
  APPONLYFLAGS="$APPONLYFLAGS,-DTRANSP_USE_GFEM_AT_BOUNDARY"
  MESSAGE="$MESSAGE\nTRANSP_USE_GFEM_AT_BOUNDARY = YES"
else
  MESSAGE="$MESSAGE\nTRANSP_USE_GFEM_AT_BOUNDARY = NO"
fi

#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#
#-#-#-#-#               Add flags for hydrodynamic model              #-#-#-#-#
#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#

# Apply integration by parts to the divergence term
if [ -n "$HYDRO_USE_IBP" -a "$HYDRO_USE_IBP" = "YES" ]
then
  APPONLYFLAGS="$APPONLYFLAGS,-DHYDRO_USE_IBP"
  MESSAGE="$MESSAGE\nHYDRO_USE_IBP = YES"
else
  MESSAGE="$MESSAGE\nHYDRO_USE_IBP = NO"
fi

# Apply group finite element formulation also at the boundary
if [ -n "$HYDRO_USE_GFEM_AT_BOUNDARY" -a "$HYDRO_USE_GFEM_AT_BOUNDARY" = "YES" ]
then
  APPONLYFLAGS="$APPONLYFLAGS,-DHYDRO_USE_GFEM_AT_BOUNDARY"
  MESSAGE="$MESSAGE\nHYDRO_USE_GFEM_AT_BOUNDARY = YES"
else
  MESSAGE="$MESSAGE\nHYDRO_USE_GFEM_AT_BOUNDARY = NO"
fi

# Apply entropy fix for inviscid fluxes
if [ -n "$HYDRO_USE_ENTROPYFIX" -a "$HYDRO_USE_ENTROPYFIX" = "YES" ]
then
  APPONLYFLAGS="$APPONLYFLAGS,-DHYDRO_USE_ENTROPYFIX"
  MESSAGE="$MESSAGE\nHYDRO_USE_ENTROPYFIX = YES"
else
  MESSAGE="$MESSAGE\nHYDRO_USE_ENTROPYFIX = NO"
fi

# Define the ratio of specific heats
if [ -n "$HYDRO_GAMMA" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DHYDRO_GAMMA=${HYDRO_GAMMA}"
    MESSAGE="$MESSAGE\nHYDRO_GAMMA = ${HYDRO_GAMMA}"
fi

#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#
#-#-#-#-#          Add flags for magnetochydrodynamic model           #-#-#-#-#
#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#

# Apply integration by parts to the divergence term
if [ -n "$MHD_USE_IBP" -a "$MHD_USE_IBP" = "YES" ]
then
  APPONLYFLAGS="$APPONLYFLAGS,-DMHD_USE_IBP"
  MESSAGE="$MESSAGE\nMHD_USE_IBP = YES"
else
  MESSAGE="$MESSAGE\nMHD_USE_IBP = NO"
fi

# Apply group finite element formulation also at the boundary
if [ -n "$MHD_USE_GFEM_AT_BOUNDARY" -a "$MHD_USE_GFEM_AT_BOUNDARY" = "YES" ]
then
  APPONLYFLAGS="$APPONLYFLAGS,-DMHD_USE_GFEM_AT_BOUNDARY"
  MESSAGE="$MESSAGE\nMHD_USE_GFEM_AT_BOUNDARY = YES"
else
  MESSAGE="$MESSAGE\nMHD_USE_GFEM_AT_BOUNDARY = NO"
fi

# Apply entropy fix for inviscid fluxes
if [ -n "$MHD_USE_ENTROPYFIX" -a "$MHD_USE_ENTROPYFIX" = "YES" ]
then
  APPONLYFLAGS="$APPONLYFLAGS,-DMHD_USE_ENTROPYFIX"
  MESSAGE="$MESSAGE\nMHD_USE_ENTROPYFIX = YES"
else
  MESSAGE="$MESSAGE\nMHD_USE_ENTROPYFIX = NO"
fi

# Define the ratio of specific heats
if [ -n "$MHD_GAMMA" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DMHD_GAMMA=${MHD_GAMMA}"
    MESSAGE="$MESSAGE\nMHD_GAMMA = ${MHD_GAMMA}"
fi

# Define the vacuum permeability coefficient
if [ -n "$MHD_VACUUM_PERM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DMHD_VACUUM_PERM=${MHD_VACUUM_PERM}"
    MESSAGE="$MESSAGE\nMHD_VACUUM_PERM = ${MHD_VACUUM_PERM}"
fi

# Define the constant value of the x-component of the magnetic field in 1D
if [ -n "$MHD_X_MAGNETICFIELD_CONSTANT_1D" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DMHD_X_MAGNETICFIELD_CONSTANT_1D=${MHD_X_MAGNETICFIELD_CONSTANT_1D}"
    MESSAGE="$MESSAGE\nMHD_X_MAGNETICFIELD_CONSTANT_1D = ${MHD_X_MAGNETICFIELD_CONSTANT_1D}"
fi

#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#
#-#-#-#-#               Add flags for kernel routines                 #-#-#-#-#
#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#

if [ -n "$MEMORY_LAYOUT" ]
then 
     APPONLYFLAGS="$APPONLYFLAGS,-DMEMORY_LAYOUT=${MEMORY_LAYOUT}"
     MESSAGE="$MESSAGE\nMEMORY_LAYOUT = ${MEMORY_LAYOUT}"
fi

if [ -n "$GFSYS_USE_SAFE_FPA" -a "$GFSYS_USE_SAFE_FPA" = "YES" ]
then
  APPONLYFLAGS="$APPONLYFLAGS,-DGFSYS_USE_SAFE_FPA"
  MESSAGE="$MESSAGE\nGFSYS_USE_SAFE_FPA = YES"
else
  MESSAGE="$MESSAGE\nGFSYS_USE_SAFE_FPA = NO"
fi

if [ -n "$GFSC_USE_SAFE_FPA" -a "$GFSC_USE_SAFE_FPA" = "YES" ]
then
  APPONLYFLAGS="$APPONLYFLAGS,-DGFSC_USE_SAFE_FPA"
  MESSAGE="$MESSAGE\nGFSC_USE_SAFE_FPA = YES"
else
  MESSAGE="$MESSAGE\nGFSC_USE_SAFE_FPA = NO"
fi

#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#
#-#-#-#-#     Add flags for blocking and OpenMP parallelisation       #-#-#-#-#
#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#-#

if [ -n "LINALG_NMIN_OMP" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DLINALG_NMIN_OMP=${LINALG_NMIN_OMP}"
    MESSAGE="$MESSAGE\nLINALG_NMIN_OMP = ${LINALG_NMIN_OMP}"
fi

if [ -n "LSYSSC_NEQMIN_OMP" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DLSYSSC_NEQMIN_OMP=${LSYSSC_NEQMIN_OMP}"
    MESSAGE="$MESSAGE\nLSYSSC_NEQMIN_OMP = ${LSYSSC_NEQMIN_OMP}"
fi

if [ -n "AFCSTAB_NEDGEMIN_OMP" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DAFCSTAB_NEDGEMIN_OMP=${AFCSTAB_NEDGEMIN_OMP}"
    MESSAGE="$MESSAGE\nAFCSTAB_NEDGEMIN_OMP = ${AFCSTAB_NEDGEMIN_OMP}"
fi

if [ -n "GFSC_NEQMIN_OMP" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DGFSC_NEQMIN_OMP=${GFSC_NEQMIN_OMP}"
    MESSAGE="$MESSAGE\nGFSC_NEQMIN_OMP = ${GFSC_NEQMIN_OMP}"
fi

if [ -n "GFSC_NEDGEMIN_OMP" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DGFSC_NEDGEMIN_OMP=${GFSC_NEDGEMIN_OMP}"
    MESSAGE="$MESSAGE\nGFSC_NEDGEMIN_OMP = ${GFSC_NEDGEMIN_OMP}"
fi

if [ -n "GFSYS_NEQMIN_OMP" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DGFSYS_NEQMIN_OMP=${GFSYS_NEQMIN_OMP}"
    MESSAGE="$MESSAGE\nGFSYS_NEQMIN_OMP = ${GFSYS_NEQMIN_OMP}"
fi

if [ -n "GFSYS_NEDGEMIN_OMP" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DGFSYS_NEDGEMIN_OMP=${GFSYS_NEDGEMIN_OMP}"
    MESSAGE="$MESSAGE\nGFSYS_NEDGEMIN_OMP = ${GFSYS_NEDGEMIN_OMP}"
fi

if [ -n "BILF_NELEMSIM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DBILF_NELEMSIM=${BILF_NELEMSIM}"
    MESSAGE="$MESSAGE\nBILF_NELEMSIM = ${BILF_NELEMSIM}"
fi

if [ -n "LINF_NELEMSIM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DLINF_NELEMSIM=${LINF_NELEMSIM}"
    MESSAGE="$MESSAGE\nLINF_NELEMSIM = ${LINF_NELEMSIM}"
fi

if [ -n "GFSC_NEQSIM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DGFSC_NEQSIM=${GFSC_NEQSIM}"
    MESSAGE="$MESSAGE\nGFSC_NEQSIM = ${GFSC_NEQSIM}"
fi

if [ -n "GFSC_NEDGESIM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DGFSC_NEDGESIM=${GFSC_NEDGESIM}"
    MESSAGE="$MESSAGE\nGFSC_NEDGESIM = ${GFSC_NEDGESIM}"
fi

if [ -n "GFSYS_NEQSIM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DGFSYS_NEQSIM=${GFSYS_NEQSIM}"
    MESSAGE="$MESSAGE\nGFSYS_NEQSIM = ${GFSYS_NEQSIM}"
fi

if [ -n "GFSYS_NEDGESIM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DGFSYS_NEDGESIM=${GFSYS_NEDGESIM}"
    MESSAGE="$MESSAGE\nGFSYS_NEDGESIM = ${GFSYS_NEDGESIM}"
fi

if [ -n "FPAR_NITEMSIM" ]
then
    APPONLYFLAGS="$APPONLYFLAGS,-DFPAR_NITEMSIM=${FPAR_NITEMSIM}"
    MESSAGE="$MESSAGE\nFPAR_NITEMSIM = ${FPAR_NITEMSIM}"
fi
