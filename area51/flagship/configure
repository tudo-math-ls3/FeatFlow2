#!/bin/sh

# Include configuration file
. ./flagship.conf

# Enable auto-tuning using genetic algorithms.
# APPONLYFLAGS="$APPONLYFLAGS,-DENABLE_AUTOTUNE"

# Specify header files which should be copied to the object directory
HEADER_FILES_TO_COPY="src/flagship.h src/models/hydro/hydro.h src/models/mhd/mhd.h src/kernel/thermodynamics.h src/kernel/magnetohydrodynamics.h"

# Specify list of application source files
# (disable any ls alias setting)
SRCLIST_APP="`\ls src/*.f90 src/models/*/*.f90 src/kernel/*.f90 2>/dev/null` "

# Add CUDA support (if available)
# (disable any ls alias setting)
SRCEXTRA_APP="`\ls src/models/*/*.cu 2>/dev/null` "
#SRCEXTRA_APP=" "

# Use system-wide configure
../../bin/configure \
    --appname=flagship-\$\(ID\) \
    --programfile=src/flagship.f90 \
    --srclist_app="${SRCLIST_APP}" \
    --srcextra_app="${SRCEXTRA_APP}" \
    --header-files-to-copy="${HEADER_FILES_TO_COPY}" \
    --apponlyflags="${APPONLYFLAGS}" \
    $@

printf "Application will be compiled with the following flags:\n"
printf "${MESSAGE}\n\n"
