# ------------------------------------------------------------------------
# Linear solver
#
# This file contains parameters that configure the behavious of
# the linear sub-solver for CCxD.
# ------------------------------------------------------------------------

# ========================================================================
# The following section describes the parameters of the multigrid solver.
# When a parameter is deleted or commented out, the standard value is used.
#
# The first couple of parameters are valid for all types of linear solvers:

##############
[CC-MULTIGRID]
##############

# Type identifier of the solver.
# 9=Multigrid, 11=UMFPACK

isolverType = 9

# Minimum number of steps

nminIterations     = 2

# Maximum number of steps

nmaxIterations     = 10

# Damping of residuals, i.e. reduction of relative error 
# on finest grid; smaller -> more iterations

depsRel            = 0.1

# Limit for residuals, i.e. absolute error on finest grid; 
# The linear solver stops if both, absolute error < depsAbs and 
# rel. error < depsRel

depsAbs            = 0.1

# General damping parameter for linear solver (e.g. for Jacobi,SSOR,...); 
# not used if MG is the linear solver.

domega             = 1.0

# Output level of the solver

ioutputLevel       = 2

# How to check residuals.
# =0: Check in Euclidian norm (like in old CC).

iresNorm = 0

# ------General multigrid parameters, coarse grid correction--------------
#
# The following parameters are multigrid specific
#
# Cycle identifier. 0=F-cycle, 1=V-cycle, 2=W-cycle

icycle             = 0

# Method to calculate the optimal MG-ALPHA, i.e. the optimal damping 
# parameter for the coarse grid correction.
# =0: use constant 1.0 = standard for conforming elements.
# =1: use energy minimisation = standard for Q1~/Q0 discretisation
# =2: use defect minimisation
ccorrectionTypeAlpha = 1

# lower limit for optimal MG-ALPHA; 
# controls damping of coarse grid correction; Standard=-10.0

dalphaMin          = -10.0

# upper limit for optimal MG-ALPHA; 
# controls damping of coarse grid correction; Standard=10.0

dalphaMax          = 10.0

# Name of the pre- and post-smoother. This is the name of another 
# subsection in this file which describes the actual smoother.
# Both names can be identical, then the same configuration is used
# as pre- and postsmoother.

spreSmootherName   = 'CC-VANCA2DQ1TP0'
spostSmootherName  = 'CC-VANCA2DQ1TP0'

# Name of the coarse grid solver. This is the name of another 
# subsection in this file which describes the actual smoother.

scoarseGridSolver  = 'CC-UMFPACK'
#scoarseGridSolver  = 'CC-VANCA2DQ1TP0-COARSE'

# ========================================================================
# The following section describes the parameters of the VANCA smoother.
# When a parameter is deleted or commented out, the standard value is used.

#################
[CC-VANCA2DQ1TP0]
#################

# Type identifier of the solver that should be used as smoother.
# 54=Vanca

isolverType        = 54

# Subtype identifier of the smoother.
# Note: Usually, the best variants are 0 (completely general), 3 or 5.
# Standard value for Navier-Stokes is = 3.
# 0=general VANCA (slow, but independent of the discretisation and of the problem)
# 1=general VANCA; 'direct' method, bypassing the defect correction approach.
#   (-> specialised variant of 0, but slightly faster)
# 2=Simple Jacobi-like VANCA, 2D Navier Stokes problem, general discretisation
#   (i.e. automatically chooses the best suitable VANCA variant).
# 3=Simple Jacobi-like VANCA, 2D Navier Stokes problem, general discretisation
#   (i.e. automatically chooses the best suitable VANCA variant).
#   'direct' method, bypassing the defect correction approach.
#   (-> specialised variant of 8, but faster)
# 4=Full VANCA, 2D Navier Stokes problem, general discretisation
#   (i.e. automatically chooses the best suitable VANCA variant).
# 5=Full VANCA, 2D Navier Stokes problem, general discretisation
#   (i.e. automatically chooses the best suitable VANCA variant).
#   'direct' method, bypassing the defect correction approach.
#   (-> specialised variant of 10, but faster)

isolverSubtype     = 3

# Number of smoothing steps

nsmoothingSteps    = 4

# Relaxation parameter

domega             = 1.0

# ========================================================================
# The following section describes the parameters of the VANCA coarse grid
# solver.
# When a parameter is deleted or commented out, the standard value is used.

########################
[CC-VANCA2DQ1TP0-COARSE]
########################

# Type identifier of the solver that should be used.
# 7=BiCGStab, 1=Defect correction

isolverType        = 1

# Minimum number of steps

nminIterations     = 1

# Maximum number of steps

nmaxIterations     = 100

# Damping of residuals, i.e. reduction of relative error 
# on finest grid; smaller -> more iterations

depsRel            = 0.01

# Limit for residuals, i.e. absolute error on finest grid; 
# The linear solver stops if both, absolute error < depsAbs and 
# rel. error < depsRel

depsAbs            = 0.01

# Output level of the solver

ioutputLevel       = 0

# VANCA preconditioner

spreconditioner = 'CC-VANCA2DQ1TP0-COARSEPRECOND'

###############################
[CC-VANCA2DQ1TP0-COARSEPRECOND]
###############################

# Preconditioner for the coarse grid solver: VANCA
# 54=Vanca

isolverType        = 54

# Subtype identifier of the VANCA-type.
# 0=2=general VANCA, 
# 1=3=Simple Jacobi-like VANCA, 2D saddle-point problem, $\tilde Q_1/P_0$
# discretisation

isolverSubtype     = 1

# Relaxation parameter

domega             = 0.7


# ========================================================================
# The following section describes the parameters of the UMFPACK solver.
# When a parameter is deleted or commented out, the standard value is used.

############
[CC-UMFPACK]
############

# Type identifier of the smoother.
# 11=UMFPACK

isolverType        = 11
