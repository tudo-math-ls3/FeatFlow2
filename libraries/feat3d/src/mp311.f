      SUBROUTINE MP311(DX1,DX2,KVERT1,KVERT2,KADJ1,KADJ2,
     *                 NVT1,NVT2,NEL1,NEL2)
      IMPLICIT DOUBLE PRECISION (A,C-H,O-U,W-Z),LOGICAL(B)
      PARAMETER (NNVE=8,NNAE=6)
      DIMENSION DX1(1),DX2(1),KVERT1(NNVE,1),KVERT2(NNVE,1),
     *          KADJ1(NNAE,1),KADJ2(NNAE,1)
C
C
C
      CALL LCP1(DX1,DX2,NVT1)
C
      DO 10 IEL1=1,NEL1
C
      DXH1=0.5D0*DX1(KVERT1(1,IEL1))
      DXH2=0.5D0*DX1(KVERT1(2,IEL1))
      DXH3=0.5D0*DX1(KVERT1(3,IEL1))
      DXH4=0.5D0*DX1(KVERT1(4,IEL1))
      DXH5=0.5D0*DX1(KVERT1(5,IEL1))
      DXH6=0.5D0*DX1(KVERT1(6,IEL1))
      DXH7=0.5D0*DX1(KVERT1(7,IEL1))
      DXH8=0.5D0*DX1(KVERT1(8,IEL1))
C
      IELH1=IEL1
      IELH2=KADJ2(3,IELH1)
      IELH3=KADJ2(3,IELH2)
      IELH4=KADJ2(3,IELH3)
      IELH5=KADJ2(6,IELH1)
      IELH6=KADJ2(3,IELH5)
      IELH7=KADJ2(3,IELH6)
      IELH8=KADJ2(3,IELH7)
C
      IF ((KADJ1(1,IEL1).GT.IEL1).OR.(KADJ1(1,IEL1).EQ.0)) 
     *   DX2(KVERT2(3,IELH1))=0.5D0*(DXH1+DXH2+DXH3+DXH4)
C
      IF ((KADJ1(2,IEL1).GT.IEL1).OR.(KADJ1(2,IEL1).EQ.0)) 
     *   DX2(KVERT2(6,IELH1))=0.5D0*(DXH1+DXH2+DXH5+DXH6)
C
      IF ((KADJ1(3,IEL1).GT.IEL1).OR.(KADJ1(3,IEL1).EQ.0)) 
     *   DX2(KVERT2(6,IELH2))=0.5D0*(DXH2+DXH3+DXH6+DXH7)
C
      IF ((KADJ1(4,IEL1).GT.IEL1).OR.(KADJ1(4,IEL1).EQ.0)) 
     *   DX2(KVERT2(6,IELH3))=0.5D0*(DXH3+DXH4+DXH7+DXH8)
C
      IF ((KADJ1(5,IEL1).GT.IEL1).OR.(KADJ1(5,IEL1).EQ.0)) 
     *   DX2(KVERT2(6,IELH4))=0.5D0*(DXH1+DXH4+DXH5+DXH8)
C
      IF ((KADJ1(6,IEL1).GT.IEL1).OR.(KADJ1(6,IEL1).EQ.0)) 
     *   DX2(KVERT2(3,IELH5))=0.5D0*(DXH5+DXH6+DXH7+DXH8)
C
C
      IF (((KADJ1(1,IEL1).GT.IEL1).OR.(KADJ1(1,IEL1).EQ.0)).AND.
     *    ((KADJ1(2,IEL1).GT.IEL1).OR.(KADJ1(2,IEL1).EQ.0))) 
     *   DX2(KVERT2(2,IELH1))=DXH1+DXH2
C
      IF (((KADJ1(1,IEL1).GT.IEL1).OR.(KADJ1(1,IEL1).EQ.0)).AND.
     *    ((KADJ1(3,IEL1).GT.IEL1).OR.(KADJ1(3,IEL1).EQ.0))) 
     *   DX2(KVERT2(2,IELH2))=DXH2+DXH3
C
      IF (((KADJ1(1,IEL1).GT.IEL1).OR.(KADJ1(1,IEL1).EQ.0)).AND.
     *    ((KADJ1(4,IEL1).GT.IEL1).OR.(KADJ1(4,IEL1).EQ.0))) 
     *   DX2(KVERT2(2,IELH3))=DXH3+DXH4
C
      IF (((KADJ1(1,IEL1).GT.IEL1).OR.(KADJ1(1,IEL1).EQ.0)).AND.
     *    ((KADJ1(5,IEL1).GT.IEL1).OR.(KADJ1(5,IEL1).EQ.0))) 
     *   DX2(KVERT2(2,IELH4))=DXH1+DXH4
C
      IF (((KADJ1(5,IEL1).GT.IEL1).OR.(KADJ1(5,IEL1).EQ.0)).AND.
     *    ((KADJ1(2,IEL1).GT.IEL1).OR.(KADJ1(2,IEL1).EQ.0))) 
     *   DX2(KVERT2(5,IELH1))=DXH1+DXH5
C
      IF (((KADJ1(2,IEL1).GT.IEL1).OR.(KADJ1(2,IEL1).EQ.0)).AND.
     *    ((KADJ1(3,IEL1).GT.IEL1).OR.(KADJ1(3,IEL1).EQ.0))) 
     *   DX2(KVERT2(5,IELH2))=DXH2+DXH6
C
      IF (((KADJ1(3,IEL1).GT.IEL1).OR.(KADJ1(3,IEL1).EQ.0)).AND.
     *    ((KADJ1(4,IEL1).GT.IEL1).OR.(KADJ1(4,IEL1).EQ.0))) 
     *   DX2(KVERT2(5,IELH3))=DXH3+DXH7
C
      IF (((KADJ1(4,IEL1).GT.IEL1).OR.(KADJ1(4,IEL1).EQ.0)).AND.
     *    ((KADJ1(5,IEL1).GT.IEL1).OR.(KADJ1(5,IEL1).EQ.0))) 
     *   DX2(KVERT2(5,IELH4))=DXH4+DXH8
C
      IF (((KADJ1(6,IEL1).GT.IEL1).OR.(KADJ1(6,IEL1).EQ.0)).AND.
     *    ((KADJ1(2,IEL1).GT.IEL1).OR.(KADJ1(2,IEL1).EQ.0))) 
     *   DX2(KVERT2(2,IELH5))=DXH5+DXH6
C
      IF (((KADJ1(6,IEL1).GT.IEL1).OR.(KADJ1(6,IEL1).EQ.0)).AND.
     *    ((KADJ1(3,IEL1).GT.IEL1).OR.(KADJ1(3,IEL1).EQ.0))) 
     *   DX2(KVERT2(2,IELH6))=DXH6+DXH7
C
      IF (((KADJ1(6,IEL1).GT.IEL1).OR.(KADJ1(6,IEL1).EQ.0)).AND.
     *    ((KADJ1(4,IEL1).GT.IEL1).OR.(KADJ1(4,IEL1).EQ.0))) 
     *   DX2(KVERT2(2,IELH7))=DXH7+DXH8
C
      IF (((KADJ1(6,IEL1).GT.IEL1).OR.(KADJ1(6,IEL1).EQ.0)).AND.
     *    ((KADJ1(5,IEL1).GT.IEL1).OR.(KADJ1(5,IEL1).EQ.0))) 
     *   DX2(KVERT2(2,IELH8))=DXH5+DXH8
C
      DX2(KVERT2(7,IELH1))=0.25D0*(DXH1+DXH2+DXH3+DXH4+
     *                             DXH5+DXH6+DXH7+DXH8)
C
10    CONTINUE
C
C
C
      END
