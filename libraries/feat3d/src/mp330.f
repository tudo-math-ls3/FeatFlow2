      SUBROUTINE MP330(DX1,DX2,KAREA1,KAREA2,KADJ1,KADJ2,NAT1,NAT2,
     *                 NEL1,NEL2)
      IMPLICIT DOUBLE PRECISION (A,C-H,O-U,W-Z),LOGICAL(B)
      PARAMETER (NNAE=6)
      PARAMETER (A1= 0.5D0,A2= 0.125D0,A3=-0.125D0,A4= 0D0)
      PARAMETER (A5=0.5D0,A6=0D0,A7=0D0)
      DIMENSION DX1(1),DX2(1),KAREA1(NNAE,1),KAREA2(NNAE,1),
     *          KADJ1(NNAE,1),KADJ2(NNAE,1)
C
C
C
      CALL LCL1(DX2,NAT2)
C
      DO 10 IEL1=1,NEL1
C
      DY1=DX1(KAREA1(1,IEL1))
      DY2=DX1(KAREA1(2,IEL1))
      DY3=DX1(KAREA1(3,IEL1))
      DY4=DX1(KAREA1(4,IEL1))
      DY5=DX1(KAREA1(5,IEL1))
      DY6=DX1(KAREA1(6,IEL1))
C
      IELH1=IEL1
      IELH2=KADJ2(3,IELH1)
      IELH3=KADJ2(3,IELH2)
      IELH4=KADJ2(3,IELH3)
      IELH5=KADJ2(6,IELH1)
      IELH6=KADJ2(3,IELH5)
      IELH7=KADJ2(3,IELH6)
      IELH8=KADJ2(3,IELH7)
C
      IF (KADJ1(1,IEL1).NE.0) THEN 
       DX2(KAREA2(1,IELH1))=DX2(KAREA2(1,IELH1))+
     *                      A1*DY1+A2*DY2+A3*DY3+A3*DY4+A2*DY5
       DX2(KAREA2(1,IELH2))=DX2(KAREA2(1,IELH2))+
     *                      A1*DY1+A2*DY2+A2*DY3+A3*DY4+A3*DY5
       DX2(KAREA2(1,IELH3))=DX2(KAREA2(1,IELH3))+
     *                      A1*DY1+A3*DY2+A2*DY3+A2*DY4+A3*DY5
       DX2(KAREA2(1,IELH4))=DX2(KAREA2(1,IELH4))+
     *                      A1*DY1+A3*DY2+A3*DY3+A2*DY4+A2*DY5
      ENDIF
C
C
      IF (KADJ1(2,IEL1).NE.0) THEN 
       DX2(KAREA2(2,IELH1))=DX2(KAREA2(2,IELH1))+
     *                      A2*DY1+A1*DY2+A3*DY3+A2*DY5+A3*DY6
       DX2(KAREA2(5,IELH2))=DX2(KAREA2(5,IELH2))+
     *                      A2*DY1+A1*DY2+A2*DY3+A3*DY5+A3*DY6
       DX2(KAREA2(5,IELH6))=DX2(KAREA2(5,IELH6))+
     *                      A3*DY1+A1*DY2+A2*DY3+A3*DY5+A2*DY6
       DX2(KAREA2(2,IELH5))=DX2(KAREA2(2,IELH5))+
     *                      A3*DY1+A1*DY2+A3*DY3+A2*DY5+A2*DY6
      ENDIF
C
C
      IF (KADJ1(3,IEL1).NE.0) THEN 
       DX2(KAREA2(2,IELH2))=DX2(KAREA2(2,IELH2))+
     *                      A2*DY1+A2*DY2+A1*DY3+A3*DY4+A3*DY6
       DX2(KAREA2(5,IELH3))=DX2(KAREA2(5,IELH3))+
     *                      A2*DY1+A3*DY2+A1*DY3+A2*DY4+A3*DY6
       DX2(KAREA2(5,IELH7))=DX2(KAREA2(5,IELH7))+
     *                      A3*DY1+A3*DY2+A1*DY3+A2*DY4+A2*DY6
       DX2(KAREA2(2,IELH6))=DX2(KAREA2(2,IELH6))+
     *                      A3*DY1+A2*DY2+A1*DY3+A3*DY4+A2*DY6
      ENDIF
C
C
      IF (KADJ1(4,IEL1).NE.0) THEN 
       DX2(KAREA2(2,IELH3))=DX2(KAREA2(2,IELH3))+
     *                      A2*DY1+A2*DY3+A1*DY4+A3*DY5+A3*DY6
       DX2(KAREA2(5,IELH4))=DX2(KAREA2(5,IELH4))+
     *                      A2*DY1+A3*DY3+A1*DY4+A2*DY5+A3*DY6
       DX2(KAREA2(5,IELH8))=DX2(KAREA2(5,IELH8))+
     *                      A3*DY1+A3*DY3+A1*DY4+A2*DY5+A2*DY6
       DX2(KAREA2(2,IELH7))=DX2(KAREA2(2,IELH7))+
     *                      A3*DY1+A2*DY3+A1*DY4+A3*DY5+A2*DY6
      ENDIF
C
C
      IF (KADJ1(5,IEL1).NE.0) THEN 
       DX2(KAREA2(2,IELH4))=DX2(KAREA2(2,IELH4))+
     *                      A2*DY1+A3*DY2+A2*DY4+A1*DY5+A3*DY6
       DX2(KAREA2(5,IELH1))=DX2(KAREA2(5,IELH1))+
     *                      A2*DY1+A2*DY2+A3*DY4+A1*DY5+A3*DY6
       DX2(KAREA2(5,IELH5))=DX2(KAREA2(5,IELH5))+
     *                      A3*DY1+A2*DY2+A3*DY4+A1*DY5+A2*DY6
       DX2(KAREA2(2,IELH8))=DX2(KAREA2(2,IELH8))+
     *                      A3*DY1+A3*DY2+A2*DY4+A1*DY5+A2*DY6
      ENDIF
C
C
      IF (KADJ1(6,IEL1).NE.0) THEN 
       DX2(KAREA2(1,IELH5))=DX2(KAREA2(1,IELH5))+
     *                      A2*DY2+A3*DY3+A3*DY4+A2*DY5+A1*DY6
       DX2(KAREA2(1,IELH6))=DX2(KAREA2(1,IELH6))+
     *                      A2*DY2+A2*DY3+A3*DY4+A3*DY5+A1*DY6
       DX2(KAREA2(1,IELH7))=DX2(KAREA2(1,IELH7))+
     *                      A3*DY2+A2*DY3+A2*DY4+A3*DY5+A1*DY6
       DX2(KAREA2(1,IELH8))=DX2(KAREA2(1,IELH8))+
     *                      A3*DY2+A3*DY3+A2*DY4+A2*DY5+A1*DY6
      ENDIF
C
C
      DX2(KAREA2(3,IELH1))=A5*(DY1+DY2)
      DX2(KAREA2(3,IELH2))=A5*(DY1+DY3)
      DX2(KAREA2(3,IELH3))=A5*(DY1+DY4)
      DX2(KAREA2(3,IELH4))=A5*(DY1+DY5)
C
      DX2(KAREA2(6,IELH1))=A5*(DY2+DY5)
      DX2(KAREA2(6,IELH2))=A5*(DY2+DY3)
      DX2(KAREA2(6,IELH3))=A5*(DY3+DY4)
      DX2(KAREA2(6,IELH4))=A5*(DY4+DY5)
C
      DX2(KAREA2(3,IELH5))=A5*(DY2+DY6)
      DX2(KAREA2(3,IELH6))=A5*(DY3+DY6)
      DX2(KAREA2(3,IELH7))=A5*(DY4+DY6)
      DX2(KAREA2(3,IELH8))=A5*(DY5+DY6)
C
C
10    CONTINUE
C
C
      END
