########
[OUTPUT]
########

soutputfile = ""

#############
[PARAMTRIANG]
#############

sboundary = "./data/area51_nonstoptcontrol/QUAD.prm"
smesh = "./data/area51_nonstoptcontrol/QUAD.tri"

#########
[PHYSICS]
#########

# 0 = 2D heat equation
# 1 = 2D Stokes
# 2 = 1D heat equation
cequation = $PHYSICS_CEQUATION

# Type of reference problem. Depending on cequation.
# creferenceproblem = 0: no chosen reference problem.
#
# cequation = 0/2: (1D/2D heat equation)
#
#   creferenceproblem = 1:
#      y = t^2   x1 
#
#   creferenceproblem = 2:
#      y = t^2 (1-t)^2   x1 
#      l = a t (1-t) x1
#
#   creferenceproblem = 3:
#      y = t^2 (1-t)^2   x1 
#      l = a t (1-t)^2   x1
#
#   creferenceproblem = 4:
#      y = t^2 (1-t)^2   x1 
#
#   creferenceproblem = 5:
#      y = t   x1 
#      l = (1-t) x1
#
#   creferenceproblem = 6:
#      y = t^2   x1 
#      l = (1-t)^2 x1
#
#   creferenceproblem = 7:
#     wa = exp(dpar*PI^2*t) sin(PI*x1) sin(PI*x2)
#      y = -1(2+dpar) PI^2 wa(t,x1,x2)
#      l = wa(t,x1,x2) - wa(1.0,x1,x2)
#
#   creferenceproblem = 8:
#      w = sin(Pi*x1)*sin(Pi*x2)
#      y = sin(PI*t/2) * w
#      l = (sin(PI*t/2)-1) * w
#
# cequation = 1: (2D Stokes equation)
#
#   creferenceproblem = 1:
#      y = t^2  ( x1 , -x2 , 0)
#
#   creferenceproblem = 2:
#      y = t^2 (1-t)^3  ( x2(1-x2) , 0 , 0 )
#
#   creferenceproblem = 3:
#      y = t^2 (x1^2 x2 , -x1 x2^2 , 0)
#
#   creferenceproblem = 4:
#      y = t^2 (1-t)^2  (x1^3 x2^2 , -x1^2 x2^3 , 0)
#
#   creferenceproblem = 5:
#      y = t  ( x2(1-x2) , 0 , 0 )
#   No coupling between primal and dual!
#   EXAMPLE DOES NOT WORK, NOT DIVERGENCE FREE WHEN BEING TIME DEPENDENT!
#
#   creferenceproblem = 6:
#      y = t ( x2(1-x2) , 0 , 0 )
#      lambda = (1-t) ( x2(1-x2) , 0 , 0 )
creferenceProblem = $PHYSICS_CREFERENCEPROBLEM

dviscosity = 1.0
doptControlAlpha = $PHYSICS_DOPTCONTROLALPHA
doptControlGamma = $PHYSICS_DOPTCONTROLGAMMA
dcouplePrimalToDual = 1.0
dcoupleDualToPrimal = 1.0
dcoupleTermCond = 1.0

# Equation-specific parameter.
# Used e.g. for reference Problem "Heat-equation 7".
dpar = $PHYSICS_DPAR

# Minimum time, maximum time
dtimemin = $PHYSICS_DTIMEMIN
dtimemax = $PHYSICS_DTIMEMAX

##########
[POSTPROC]
##########

# Whether or not to write UCD output
iwriteUCD = $POSTPROC_IWRITEUCD

# Whether or not to calculate the error to an analytical ref. fct.
icalcerror = 1

# Type of 1D cubature formula to use in time for error calc.
scubTimeError = G2_1D

# Name/path of the UCD output file
sucdfilename = "./gmv/u.vtk"

##########################
[SPACETIME-DISCRETISATION]
##########################

# Type of FE space.
# cfespace: -1=automatic.
# =1: 1st order (Q1, Q1~/Q0)
# =2: 2nd order (Q2, Q2/QP1)

cfespace =  $SPACETIMEDISCRETISATION_CFESPACE

nspacelevels = $SPACETIMEDISCRETISATION_NSPACELEVELS
ntimelevels = $SPACETIMEDISCRETISATION_NTIMELEVELS
nminlevelspace = $SPACETIMEDISCRETISATION_NMINLEVELSPACE
nminminleveltime = $SPACETIMEDISCRETISATION_NMINMINLEVELTIME
nmaxminleveltime = $SPACETIMEDISCRETISATION_NMAXMINLEVELTIME
dtheta = $SPACETIMEDISCRETISATION_DTHETA

# Type of the theta scheme.
# =0: Standard theta scheme for both, primal and dual.
# =1: modified theta scheme, dual solutions located
#     inbetween primal solutions in time.
ithetaschemetype = $SPACETIMEDISCRETISATION_ITHETASCHEMETYPE

# Number of timesteps on the time coarse mesh
ntimestepsCoarse = $SPACETIMEDISCRETISATION_NTIMESTEPSCOARSE

######################
[SPACETIME-REFINEMENT]
######################

# Whether space levels are coupled to time levels.
# =0: Refinement only in time: Space level NLMAX is used on all time levels.
# =1: Refinement in time and space: Space level NLMAX-i = Time level TIMENLMAX-i
# =2: Refinement only in space: Time level TIMENLMAX-i has the same number of time 
#     steps as time level TIMENLMAX, but uses space level NLMAX-i.

ispacelevelcoupledtotimelevel = $SPACETIMEREF_ISPACELEVELCOUPLEDTOTIMELEVEL

# If space and time levels are coupled:
# Factor that specifies the number of refinement levels in time before refining
# in space.
# Standard: 1.0 = each refinement in time results in a refinement in space.
# Other values e.g.:
#   2.0 = two refinements in time per refinement in space
#   0.5 = two refinements in space per refinement in time

dspacetimeRefFactor = $SPACETIMEREF_DSPACETIMEREFFACTOR

########################
[SPACETIME-LINEARSOLVER]
########################

ioutputLevel = 3

# Type of the solver.
# =-1: automatic
# =0: Defect correction with Block-JAC preconditioning.
# =1: Space-time MG
# =2: Defect correction with Block-GS preconditioning.
csolverType = $SPACETIMELINEARSOLVER_CSOLVERTYPE

nsmoothingSteps = $SPACETIMELINEARSOLVER_NSMOOTHINGSTEPS
nmaxiterations = 1000

# ONLY MULTIGRID: Type of smoother.
# =0: Block-Jacobi
# =1: Block-FBSIM, half coupled (forward-backward solver)
# =2: Block-FBGS, fully coupled
# =3: BiCGStab with Block-Jacobi
# =4: BiCGStab with Block-FBSIM, half coupled
# =5: BiCGStab with Block-FBGS, fully coupled

ismoother = $SPACETIMELINEARSOLVER_ISMOOTHER

# ONLY MULTIGRID: Type of coarse grid solver.
# =0: Block-Jacobi
# =1: Block-FBSIM, half coupled (forward-backward solver)
# =2: Block-FBGS, fully coupled (forward-backward optimiser)
# =3: BiCGStab with Block-Jacobi
# =4: BiCGStab with Block-FBSIM, half coupled (forward-backward solver)
# =5: BiCGStab with Block-FBGS, fully coupled (forward-backward optimiser)

icoarsegridsolver = $SPACETIMELINEARSOLVER_ICOARSEGRIDSOLVER

# ONLY MULTIGRID: Type of projection in time.
# -1: automatic
# =0: constant prolongation/restriction
# =1: linear prolongation/restriction. primal+dual solutions located
#     at the endpoints of the time interval.
# =2: linear prolongation/restriction, primal+dual solutions located
#     according to the 1-step theta scheme. No time negotiation, so
#     the restriction uses a constant interpolation of the primal
#     space to synchronise in time with the dual space.
# =3: linear prolongation/restriction, primal+dual solutions located
#     according to the 1-step theta scheme. Full linear restriction
#     with interpolation in time.
# =4: Piecewise cubic interpolation in the inner. Piecewise quadratic
#     extrapolation at the time endpoints. Solutions located at the
#     time endpoints. (not completely implemented)
# =5: Piecewise linear with larger stencil. Solutions located at the
#     time endpoints. (not completely implemented)

itypeProjection = $SPACETIMELINEARSOLVER_ITYPEPROJECTION

depsrel = $SPACETIMELINEARSOLVER_DEPSREL
depsabs = 1E-15

# ONLY MULTIGRID: Type of Cycle.
# =0: F-cycle, =1: V-cycle, =2: W-cycle

icycle = $SPACETIMELINEARSOLVER_ICYCLE

# ONLY MULTIGRID: Specifies the type of the adaptive coarse grid correction used.
# =0: deactivated.
# =1: adaptive coarse grid correction by energy minimisation.
iadcgcorr = 0

# Damping of the coarse grid correction
ddampingCoarseGridCorrection = $SPACETIMELINEARSOLVER_DDAMPINGCOARSEGRIDCORRECTION

dadcgcorrMin = -10.0
dadcgcorrMax = 10.0

# For 1-level solvers:

ddamping = 1.0
drelax = 1.0

# Use full (forward+backward) coupling in FBGS.
# =0: Use only one-way coupling to previous or next timestep
# =1: Use two-way coupling to previous and next timestep
ifullcouplingFBGS = 1

############################
[SPACETIME-COARSEGRIDSOLVER]
############################

ioutputlevel = $SPACETIMECOARSEGRIDSOLVER_IOUTPUTLEVEL
depsrel = $SPACETIMECOARSEGRIDSOLVER_DEPSREL
depsabs = $SPACETIMECOARSEGRIDSOLVER_DEPSABS

ddamping = $SPACETIMECOARSEGRIDSOLVER_DDAMPING
drelax = $SPACETIMECOARSEGRIDSOLVER_DRELAX

# Use full (forward+backward) coupling in FBGS.
# =0: Use only one-way coupling to previous or next timestep
# =1: Use two-way coupling to previous and next timestep

ifullcouplingFBGS = $SPACETIMECOARSEGRIDSOLVER_IFULLCOUPLINGFBGS2

# Maximum number of iterations
nmaxiterations = $SPACETIMECOARSEGRIDSOLVER_NMAXITERATIONS

####################
[SPACETIME-SMOOTHER]
####################

ioutputlevel = $SPACETIMESMOOTHER_IOUTPUTLEVEL

ddamping = $SPACETIMESMOOTHER_DDAMPING
drelax = $SPACETIMESMOOTHER_DRELAX

# Use full (forward+backward) coupling in FBGS.
# =0: Use only one-way coupling to previous or next timestep
# =1: Use two-way coupling to previous and next timestep

ifullcouplingFBGS = $SPACETIMESMOOTHER_IFULLCOUPLINGFBGS2

# Reinitialisation counter for BiCGStab
# =0: deactivate
niteReinit = 0


####################
[SPACE-LINEARSOLVER]
####################

# Type of the solver in space.
# =0: UMFPACK
# =1: Multigrid
csolverType = $SPACELINEARSOLVER_CSOLVERTYPE

# Type of smoother.
# =0: Defect correction + Jacobi/VANKA preconditioning
# =1: BiCGStab(ILU-0). Only for the heat equation.
# =2: BiCGStab(SSOR). Only for the heat equation.
csmoother = $SPACELINEARSOLVER_CSMOOTHER

# Type of coarse grid solver.
# =0: Defect correction + Jacobi/VANKA preconditioning
# =1: BiCGStab(ILU-0). Only for the heat equation.
# =2: BiCGStab(SSOR). Only for the heat equation.
ccoarsegridsolver = $SPACELINEARSOLVER_CCOARSEGRIDSOLVER

# Damping parameter for smoother.
# =1.0 for ILU, =0.7 for JAC
domegaSmoother = $SPACELINEARSOLVER_DOMEGASMOOTHER

# Relative stopping criterion
depsrel = $SPACELINEARSOLVER_DEPSREL

# Absolute stopping criterion
depsabs = $SPACELINEARSOLVER_DEPSABS

# Minimum difference in the solutions (fine+coarse grid)
depsdiff = $SPACELINEARSOLVER_DEPSDIFF

# Max. number of iterations
nmaxiterations = $SPACELINEARSOLVER_NMAXITERATIONS

# Output level
ioutputLevel = 0

# Output level coarse grid solver
ioutputLevelCoarse = 0

# Max. number of iterations on the coarse mesh
nmaxiterationsCoarse = $SPACELINEARSOLVER_NMAXITERATIONSCOARSE
